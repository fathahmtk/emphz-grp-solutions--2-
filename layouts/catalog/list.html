{{ define "main" }}
<div
    class="bg-void-950 min-h-screen text-slate-300 font-sans selection:bg-teal-500 selection:text-void-950 bg-noise relative overflow-x-hidden">

    <!-- GLOBAL DECORATION: FIXED GRID LINES -->
    <div class="fixed inset-0 pointer-events-none z-0 opacity-[0.03]">
        <div class="absolute left-6 md:left-24 top-0 bottom-0 w-px bg-white"></div>
        <div class="absolute right-6 md:right-24 top-0 bottom-0 w-px bg-white"></div>
        <div class="absolute left-1/4 top-0 bottom-0 w-px bg-white hidden md:block"></div>
        <div class="absolute left-1/2 top-0 bottom-0 w-px bg-white hidden md:block"></div>
        <div class="absolute left-3/4 top-0 bottom-0 w-px bg-white hidden md:block"></div>
    </div>

    <!-- HEADER SECTION -->
    <section class="relative pt-40 pb-20 px-6 md:px-24 z-10 border-b border-white/10">
        <div class="max-w-[1920px] mx-auto">
            <div class="flex flex-col md:flex-row justify-between items-end gap-10">
                <div class="space-y-4">
                    <div
                        class="flex items-center gap-4 text-xs font-mono text-teal-500 tracking-widest uppercase opacity-0 animate-fade-in">
                        <span class="w-12 h-px bg-teal-500"></span>
                        [ SYSTEM_DATABASE ]
                    </div>
                    <h1
                        class="text-7xl md:text-9xl font-black text-white tracking-tighter leading-[0.85] opacity-0 animate-slide-up-reveal">
                        DEPLOYMENT<br>
                        <span class="text-transparent stroke-white"
                            style="-webkit-text-stroke: 1px #fff;">MATRIX.</span>
                    </h1>
                </div>
                <div class="text-right opacity-0 animate-fade-in delay-200">
                    <div class="font-mono text-4xl text-white/10 font-bold mb-2">v.2.4</div>
                    <p class="text-xs font-mono text-slate-500 uppercase tracking-widest max-w-[200px]">
                        Global Infrastructure Component Library
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- MAIN GRID LAYOUT -->
    <section class="max-w-[1920px] mx-auto px-6 md:px-24 py-20 relative z-10">
        <div class="flex flex-col lg:flex-row gap-20">

            <!-- SIDEBAR FILTER (STICKY) -->
            <aside class="w-full lg:w-64 flex-shrink-0">
                <div class="sticky top-32 space-y-12">

                    <!-- Filter Group -->
                    <div>
                        <h3
                            class="font-mono text-[10px] items-center flex gap-2 font-bold uppercase tracking-[0.2em] text-teal-500 mb-6">
                            <span class="w-2 h-2 bg-teal-500 rounded-full animate-pulse"></span>
                            Signal Filter
                        </h3>

                        <div class="flex flex-col gap-px border-t border-white/10">
                            {{ $products := .Site.Data.products }}
                            {{ $categories := slice }}
                            {{ range $products }}
                            {{ $categories = $categories | append .category }}
                            {{ end }}
                            {{ $uniqueCategories := $categories | uniq | sort }}

                            <button
                                class="filter-btn group w-full flex items-center justify-between py-4 text-left border-b border-white/5 hover:bg-white/5 transition-all active-filter"
                                data-category="All">
                                <span
                                    class="font-mono text-xs uppercase tracking-widest text-white group-hover:text-teal-400">All_Systems</span>
                                <span class="text-[10px] font-mono text-slate-600 group-hover:text-teal-500">[{{ len
                                    $products }}]</span>
                            </button>

                            {{ range $uniqueCategories }}
                            {{ $cat := . }}
                            {{ $count := 0 }}
                            {{ range $products }}{{ if eq .category $cat }}{{ $count = add $count 1 }}{{ end }}{{ end }}
                            <button
                                class="filter-btn group w-full flex items-center justify-between py-4 text-left border-b border-white/5 hover:bg-white/5 transition-all opacity-60 hover:opacity-100"
                                data-category="{{ . }}">
                                <span
                                    class="font-mono text-xs uppercase tracking-widest text-white group-hover:text-teal-400">{{
                                    . }}</span>
                                <span class="text-[10px] font-mono text-slate-600 group-hover:text-teal-500">[{{ $count
                                    }}]</span>
                            </button>
                            {{ end }}
                        </div>
                    </div>

                    <!-- Tech Status Panel -->
                    <div class="border border-white/10 p-6 bg-void-900/50 backdrop-blur">
                        <div class="flex justify-between items-center mb-4">
                            <span class="font-mono text-[9px] text-slate-500 uppercase tracking-widest">Grid
                                Status</span>
                            <div class="w-1.5 h-1.5 bg-teal-500 rounded-full"></div>
                        </div>
                        <div class="flex gap-1 mb-2">
                            <div class="flex-1 h-32 bg-[url('/grid_noise.png')] opacity-20 border border-teal-500/20">
                            </div>
                        </div>
                        <div class="font-mono text-[9px] text-teal-500/80 leading-relaxed uppercase">
                            Warning:<br>
                            Specifications subject to environmental variables. Consult engineering before deployment.
                        </div>
                    </div>

                </div>
            </aside>

            <!-- PRODUCT GRID -->
            <main class="flex-1">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8" id="product-grid">
                    {{ range .Site.Data.products }}
                    <div class="product-item group block opacity-0 translate-y-4 animate-fade-in-up transition-all duration-700"
                        data-category="{{ .category }}">
                        <a href="/products/{{ .id }}"
                            class="block h-full border border-white/10 hover:border-teal-500/50 bg-void-900 hover:bg-void-900/80 transition-all duration-500 relative overflow-hidden">
                            <!-- Image Container -->
                            <div
                                class="aspect-[4/3] w-full overflow-hidden relative border-b border-white/10 grayscale group-hover:grayscale-0 transition-all duration-700">
                                <div
                                    class="absolute inset-0 bg-void-950/20 z-10 mix-blend-multiply transition-opacity group-hover:opacity-0">
                                </div>
                                <img src="{{ .imageUrl }}" alt="{{ .name }}"
                                    class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-1000">

                                <!-- Hover Overlay Grid -->
                                <div
                                    class="absolute inset-0 z-20 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCI+CjxwYXRoIGQ9Ik0wIDBoNDB2NDBIMHoiIGZpbGw9Im5vbmUiLz4KPHBhdGggZD0iTTAgNDBoNDBNNDAgMHY0MCIgc3Ryb2tlPSJyZ2JhKDI1NSwyNTUsMjU1LDAuMDUpIiBzdHJva2Utd2lkdGg9IjEiLz4KPC9zdmc+')] opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none">
                                </div>

                                <!-- Corner Tag -->
                                <div
                                    class="absolute top-0 right-0 p-4 z-30 opacity-0 group-hover:opacity-100 transition-opacity delay-100">
                                    <div
                                        class="bg-teal-500 text-void-950 text-[10px] font-mono font-bold px-2 py-1 uppercase tracking-widest">
                                        Active</div>
                                </div>
                            </div>

                            <!-- Content -->
                            <div class="p-8">
                                <div class="flex justify-between items-start mb-4">
                                    <span
                                        class="font-mono text-[10px] text-teal-500 border border-teal-500/30 px-2 py-0.5 rounded uppercase tracking-widest">{{
                                        .category }}</span>
                                    <span class="font-mono text-[10px] text-slate-600">ID: {{ .id }}</span>
                                </div>
                                <h2
                                    class="text-3xl font-bold text-white mb-4 group-hover:text-teal-400 transition-colors">
                                    {{ .name }}</h2>
                                <p class="text-sm text-slate-500 leading-relaxed line-clamp-2 mb-8 font-light">{{
                                    .shortDescription }}</p>

                                <div
                                    class="flex items-center gap-3 text-xs font-mono uppercase tracking-widest text-slate-400 group-hover:text-white transition-colors">
                                    <span>Access Datasheet</span>
                                    <svg class="w-4 h-4 transform group-hover:translate-x-2 transition-transform duration-300"
                                        fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                            d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                    </svg>
                                </div>
                            </div>
                        </a>
                    </div>
                    {{ end }}
                </div>
            </main>

        </div>
    </section>

</div>

<style>
    @keyframes slideUpReveal {
        0% {
            transform: translateY(100%);
            opacity: 0;
        }

        100% {
            transform: translateY(0);
            opacity: 1;
        }
    }

    .animate-slide-up-reveal {
        animation: slideUpReveal 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    .active-filter {
        opacity: 1 !important;
        background-color: rgba(255, 255, 255, 0.05);
    }

    .active-filter span:first-child {
        color: #14B8A6;
        /* teal-500 */
        font-weight: bold;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const filterBtns = document.querySelectorAll('.filter-btn');
        const productItems = document.querySelectorAll('.product-item');

        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const category = btn.getAttribute('data-category');

                // Reset all buttons
                filterBtns.forEach(b => {
                    b.classList.remove('active-filter');
                    b.classList.add('opacity-60');
                });

                // Activate clicked button
                btn.classList.add('active-filter');
                btn.classList.remove('opacity-60');

                // Filter Grid
                productItems.forEach(item => {
                    const itemCategory = item.getAttribute('data-category');

                    if (category === 'All' || itemCategory === category) {
                        item.classList.remove('hidden');
                        // Small timeout to allow display:block to apply before opacity transition
                        setTimeout(() => {
                            item.classList.remove('opacity-0', 'translate-y-4');
                            item.classList.add('opacity-100', 'translate-y-0');
                        }, 50);
                    } else {
                        item.classList.remove('opacity-100', 'translate-y-0');
                        item.classList.add('opacity-0', 'translate-y-4');
                        setTimeout(() => {
                            item.classList.add('hidden');
                        }, 500);
                    }
                });
            });
        });
    });
</script>
{{ end }}