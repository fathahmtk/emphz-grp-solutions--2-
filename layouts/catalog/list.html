{{ define "main" }}
<div class="bg-emphz-teal-black min-h-screen">
    <!-- CONCEPTUAL HEADER: THE ARCHIVE -->
    <section class="relative pt-40 pb-20 border-b border-white/5 overflow-hidden">
        <div class="absolute inset-0 z-0 opacity-10">
            <div
                class="absolute inset-0 bg-[radial-gradient(circle_at_top_right,rgba(20,184,166,0.3),transparent_70%)]">
            </div>
            <div
                class="h-full w-full bg-[linear-gradient(rgba(20,184,166,0.05)_1px,transparent_1px),linear-gradient(90deg,rgba(20,184,166,0.05)_1px,transparent_1px)] bg-[size:100px_100px]">
            </div>
        </div>

        <div class="max-w-7xl mx-auto px-6 md:px-12 relative z-10">
            <div class="flex flex-col md:flex-row justify-between items-end gap-12">
                <div class="animate-fade-in-up">
                    <div class="flex items-center gap-3 mb-6">
                        <span class="w-8 h-px bg-emphz-teal"></span>
                        <span class="font-mono text-[10px] uppercase tracking-[0.5em] text-emphz-teal">System //
                            Inventory</span>
                    </div>
                    <h1 class="text-6xl md:text-8xl font-black text-white mb-8 tracking-tighter leading-none">
                        ASSET<br /><span
                            class="text-transparent bg-clip-text bg-gradient-to-r from-emphz-teal to-emerald-400">MATRIX.</span>
                    </h1>
                </div>
                <div class="flex flex-col items-end animate-fade-in-up [animation-delay:200ms]">
                    <span class="font-mono text-[40px] font-bold text-white/5 leading-none mb-2">v.04</span>
                    <p
                        class="text-right text-industrial-500 font-mono text-[10px] uppercase tracking-widest max-w-[200px]">
                        Cross-referenced architectural components for extreme environments.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- THE MATRIX GRID -->
    <div class="max-w-7xl mx-auto px-6 md:px-12 py-24">
        <div class="flex flex-col lg:flex-row gap-20">
            <!-- SIDELINK NAVIGATION: PROTOCOLS -->
            <aside class="w-full lg:w-64 flex-shrink-0">
                <div class="sticky top-32">
                    <div class="mb-12">
                        <h3 class="font-mono text-[10px] font-bold uppercase tracking-[0.4em] text-emphz-teal mb-8">
                            Access Filter</h3>
                        <div class="space-y-1">
                            {{ $products := .Site.Data.products }}
                            {{ $categories := slice }}
                            {{ range $products }}
                            {{ $categories = $categories | append .category }}
                            {{ end }}
                            {{ $uniqueCategories := $categories | uniq | sort }}

                            <button
                                class="filter-btn group w-full flex items-center justify-between py-3 text-left transition-all border-b border-white/5"
                                data-category="All">
                                <span
                                    class="font-mono text-xs uppercase tracking-widest text-white group-hover:text-emphz-teal">All_Units</span>
                                <span class="text-[10px] font-mono text-industrial-600">[{{ len $products }}]</span>
                            </button>

                            {{ range $uniqueCategories }}
                            <button
                                class="filter-btn group w-full flex items-center justify-between py-3 text-left transition-all border-b border-white/5 opacity-50 hover:opacity-100"
                                data-category="{{ . }}">
                                <span
                                    class="font-mono text-xs uppercase tracking-widest text-white group-hover:text-emphz-teal">{{
                                    replace . " " "_" }}</span>
                                {{ $cat := . }}
                                {{ $count := 0 }}
                                {{ range $products }}{{ if eq .category $cat }}{{ $count = add $count 1 }}{{ end }}{{
                                end }}
                                <span class="text-[10px] font-mono text-industrial-600">[{{ $count }}]</span>
                            </button>
                            {{ end }}
                        </div>
                    </div>

                    <div class="p-6 border border-emphz-teal/20 bg-emphz-teal/5">
                        <div class="w-2 h-2 rounded-full bg-emphz-teal animate-pulse mb-4"></div>
                        <p class="font-mono text-[9px] leading-relaxed text-industrial-400 uppercase tracking-wider">
                            Real-time structural monitoring enabled for all GRP assets.
                            Select component to view terminal specifications.
                        </p>
                    </div>
                </div>
            </aside>

            <!-- MAIN GRID: THE TERMINALS -->
            <main class="flex-1">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12" id="product-grid">
                    {{ range .Site.Data.products }}
                    <div class="product-item group relative" data-category="{{ .category }}">
                        <a href="/products/{{ .id }}" class="block">
                            <!-- Image Canvas -->
                            <div
                                class="relative aspect-[4/5] overflow-hidden bg-emphz-teal-black border border-white/5 group-hover:border-emphz-teal/40 transition-all duration-500">
                                <img src="{{ .imageUrl }}" alt="{{ .name }}"
                                    class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110 grayscale group-hover:grayscale-0">

                                <!-- Diagnostic Corner -->
                                <div class="absolute top-4 right-4 z-10 flex flex-col items-end">
                                    <span
                                        class="font-mono text-[8px] text-white/20 uppercase tracking-[0.2em] mb-1">Status:
                                        Active</span>
                                    <div class="w-12 h-1 bg-white/10 overflow-hidden">
                                        <div class="w-2/3 h-full bg-emphz-teal"></div>
                                    </div>
                                </div>

                                <!-- Overlay Info -->
                                <div
                                    class="absolute inset-0 bg-gradient-to-t from-emphz-teal-black via-transparent to-transparent opacity-90">
                                </div>
                                <div class="absolute bottom-0 left-0 p-8 w-full">
                                    <span
                                        class="font-mono text-[9px] text-emphz-teal mb-2 block uppercase tracking-[0.3em]">{{
                                        .category }}</span>
                                    <h4
                                        class="text-3xl font-black text-white mb-4 group-hover:text-emphz-teal transition-colors tracking-tight">
                                        {{ .name }}</h4>
                                    <p
                                        class="text-xs text-industrial-500 line-clamp-2 font-light leading-relaxed mb-6 group-hover:text-industrial-300 transition-colors">
                                        {{ .shortDescription }}</p>

                                    <div
                                        class="flex items-center gap-4 text-[9px] font-mono font-bold uppercase tracking-widest text-white/30 group-hover:text-white transition-all">
                                        View_Protocol
                                        <span
                                            class="w-8 h-px bg-white/10 group-hover:w-12 group-hover:bg-emphz-teal transition-all"></span>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                    {{ end }}
                </div>
            </main>
        </div>
    </div>
</div>

<style>
    @keyframes fade-in-up {
        from {
            opacity: 0;
            transform: translateY(20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-fade-in-up {
        animation: fade-in-up 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const filterBtns = document.querySelectorAll('.filter-btn');
        const productItems = document.querySelectorAll('.product-item');

        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const category = btn.getAttribute('data-category');

                // Update UI state of buttons
                filterBtns.forEach(b => {
                    b.classList.remove('text-accent-blue', 'font-bold');
                    b.classList.add('text-industrial-400');
                    const indicator = b.querySelector('.w-3.h-3');
                    if (indicator) {
                        indicator.classList.remove('bg-accent-blue', 'border-accent-blue');
                        indicator.classList.add('border-industrial-200');
                        const innerDot = indicator.querySelector('div');
                        if (innerDot) innerDot.classList.add('opacity-0');
                    }
                });

                btn.classList.add('text-accent-blue', 'font-bold');
                btn.classList.remove('text-industrial-400');
                const activeIndicator = btn.querySelector('.w-3.h-3');
                if (activeIndicator) {
                    activeIndicator.classList.add('bg-accent-blue', 'border-accent-blue');
                    activeIndicator.classList.remove('border-industrial-200');
                    const activeDot = activeIndicator.querySelector('div');
                    if (activeDot) activeDot.classList.remove('opacity-0');
                }

                // Filter products
                productItems.forEach(item => {
                    if (category === 'All' || item.getAttribute('data-category') === category) {
                        item.classList.remove('hidden');
                        setTimeout(() => item.style.opacity = '1', 10);
                    } else {
                        item.style.opacity = '0';
                        setTimeout(() => item.classList.add('hidden'), 300);
                    }
                });
            });
        });
    });
</script>
{{ end }}